<div class="container-fluid">

      <div class="row">
        <div class="col-md-12">
          <zxing-scanner
          (scanSuccess)="scanSuccessHandler($event)"
          [style.display]="scannerEnabled? 'block': 'none'"></zxing-scanner>
        </div>
      </div>

      <div class="row">
        <div class="col-md-12">

          <div class ="row">
            <div class="col-md-12">
              <form (ngSubmit)="onSubmit()" #f="ngForm">
                <input placeholder="Order ID" type="text" id="orderId" class="form-control"
                name="orderId" [(ngModel)]="orderId" required>
                <button class="btn btn-primary" type="submit" [disabled]="!f.valid || prevOrderId==orderId">Search</button>
              </form>
            </div>
          </div>

          <div class="row" id="order">

            <div class="col-md-12">

              <div class="row" *ngIf="isLoading; else result">
                <div class="col-md-12" id="loading">
                  <mat-spinner></mat-spinner>
                </div>
              </div>

              <ng-template #result>

                <div class="row" *ngIf="order == undefined;else foundData">
                  <div class="col-md-12">
                    <p>There is no such ticket in the database.</p>
                    <button 
                    mat-raised-button color="warn"
                    (click)="onCancel()"
                    [disabled]="scannerEnabled">Cancel</button>
                  </div>
                </div>

                <ng-template #foundData>
                  <h2>{{order.billing.first_name}} {{order.billing.last_name}}'s order</h2>
                  <table class="table table-strip" cellpadding="6" style="width: 100%; font-family: 'Helvetica Neue', Helvetica, Roboto, Arial, sans-serif;" border="1">
                    <thead>
                      <tr>
                        <th>Product</th>
                        <th>Quantity</th>
                        <th>Price</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let item of order.line_items">
                        <td>{{item.name}}</td>
                        <td>{{item.quantity}}</td>
                        <td>{{item.price}}</td>
                      </tr>
                    </tbody>
                  </table>
                  <h2>Entries</h2>
                  <table class="table table-striped" cellpadding="6" style="width: 100%; font-family: 'Helvetica Neue', Helvetica, Roboto, Arial, sans-serif;" border="1">
                    <thead>
                      <tr>
                        <th scope="col">Entry nÂ°</th>
                        <th scope="col">Hour</th>
                      </tr>
                    </thead>
                    <tbody >
                      <tr *ngFor="let item of entries; let i = index;">
                        <th scope="row">{{i+1}}</th>
                        <td>{{item.timestamp | date:'dd/MM/YY hh:mm:ss'}}</td>
                      </tr>
                    </tbody>
                  </table>

                  <div class="row" id="buttons">
                    <button mat-fab color="warn"
                    (click)="onCancel()">
                      <mat-icon>clear</mat-icon>
                    </button>
                    <button *ngIf="(order.line_items[0].quantity > entries.length)" mat-fab color="accent"
                    (click)="onAddEntry()">
                      <mat-icon>done</mat-icon>
                    </button>
                  </div>

                </ng-template>

              </ng-template>

            </div>
            
          </div>
          


        </div>
      </div>
</div>